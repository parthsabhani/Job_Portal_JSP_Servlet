package com.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import com.model.CompanyModel;
import com.model.UserModel;
import com.util.ConnectionClass;

public class CompanyDao 
{
	Connection c= null;
	
	public boolean isEmailExist(String email)
	{
		boolean isExist = false;
		c = ConnectionClass.getConnection();
		String q = "select * from company where email = ?";
		try 
		{			
			PreparedStatement ps = c.prepareStatement(q);
			ps.setString(1, email);
			
			ResultSet rs = ps.executeQuery();
			
			while(rs.next())
			{
				isExist = true;
			}
		}
		catch (Exception e)
		{
			e.printStackTrace();
		}
		return isExist;
	}
	
	public int companyRegistration(CompanyModel rmodel)
	{
		int x= 0;
		
		c = ConnectionClass.getConnection();
		String q = "INSERT INTO company (name, email, address, phone, website, password)"
				+ " VALUES (?, ?, ?, ?, ?, ?)";
		
		try 
		{
			PreparedStatement ps = c.prepareStatement(q);
			ps.setString(1, rmodel.getName());
			ps.setString(2, rmodel.getEmail());
			ps.setString(3, rmodel.getAddress());
			ps.setString(4, rmodel.getPhone());
			ps.setString(5, rmodel.getWebsite());
			ps.setString(6, rmodel.getPassword());
			
			x = ps.executeUpdate();
			c.close();
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
		return x;
	}
	
	public CompanyModel companyLogin(String email, String password)
	{
		CompanyModel model = null;
		
		c = ConnectionClass.getConnection();
		String q = "select * from company where email = ? and password = ?";
		
		try 
		{
			PreparedStatement ps = c.prepareStatement(q);
			ps.setString(1, email);
			ps.setString(2, password);
			
			ResultSet rs = ps.executeQuery();
			
			while(rs.next())
			{
				 model.setCompanyid(rs.getInt("companyid"));
				 model.setFirstName(rs.getString("name"));
				 model.setLastName(rs.getString("email"));
				 model.setEmail(rs.getString("address"));
				 model.setAge(rs.getInt("phone"));
				 model.setGender(rs.getString(""));
				 model.setAddress(rs.getString("address"));
				 model.setPhone(rs.getString("phone"));
				 model.setPassword(rs.getString("password"));
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
		return model;
	}

}
